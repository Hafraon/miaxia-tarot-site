<!doctype html>
<html lang="uk">
  <head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NVMR3CJ2');</script>
    <!-- End Google Tag Manager -->
    
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/tarot.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MiaxiaLip | –ö–ª—é—á –¥–æ –≤–∞—à–æ–≥–æ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Raleway:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <meta name="description" content="MiaxiaLip - –ø—ñ–∑–Ω–∞–π—Ç–µ —Ç–∞—î–º–Ω–∏—Ü—ñ –¥–æ–ª—ñ —Ä–∞–∑–æ–º –∑—ñ —Å–ø—Ä–∞–≤–∂–Ω—ñ–º –º–∞–π—Å—Ç—Ä–æ–º —Ç–∞—Ä–æ. –Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ —Ä–æ–∑–∫–ª–∞–¥–∏, –ª—é–±–æ–≤–Ω—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏, –∫–∞—Ä'—î—Ä–Ω–µ –∫–æ–Ω—Å—É–ª—å—Ç—É–≤–∞–Ω–Ω—è." />
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17416940719"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-7239891504"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'AW-17416940719');
      gtag('config', 'AW-7239891504');
      gtag('config', 'G-GDEVM541ZP');
    </script>
    
    <script type="module" crossorigin src="/assets/index-CVuxTPtp.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-BF3mJlfA.css">
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NVMR3CJ2"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="root"></div>
    
    <!-- Telegram —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è - –ú–Ü–ù–Ü–ú–ê–õ–¨–ù–ê –í–ï–†–°–Ü–Ø -->
    <script>
      // –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Telegram
      const TELEGRAM_CONFIG = {
        chatId: '603047391',
        botToken: '7322148325:AAHWjMEFuBVVoUhsPQ6SOsSTBE2fxFZfeXU',
        recipientEmail: 'miaxialip@gmail.com'
      };

      // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤ Telegram
      async function sendToTelegram(formData) {
        try {
          const response = await fetch('/telegram-notify.php', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
          });

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const result = await response.json();
          
          if (result.success) {
            return { success: true, data: result };
          } else {
            throw new Error(result.error || 'Telegram API error');
          }
        } catch (error) {
          console.error('Telegram service error:', error);
          throw error;
        }
      }

      // –†–æ–∑—É–º–Ω–∏–π –∑–±—ñ—Ä –¥–∞–Ω–∏—Ö –∑ —Ñ–æ—Ä–º–∏ - –ë–ï–ó –ó–ê–ô–í–ò–• –ü–û–õ–Ü–í
      function smartFormDataCollection(form) {
        const inputs = Array.from(form.querySelectorAll('input, select, textarea'));
        
        const data = {
          name: '',
          email: '',
          phone: '',
          instagram: '',
          service: '',
          message: '',
          date: '',
          time: ''
        };
        
        inputs.forEach(input => {
          const value = input.value?.trim() || '';
          if (!value) return;
          
          const name = input.name?.toLowerCase() || '';
          const id = input.id?.toLowerCase() || '';
          const placeholder = input.placeholder?.toLowerCase() || '';
          const type = input.type?.toLowerCase() || '';
          
          const fieldText = `${name} ${id} ${placeholder}`.toLowerCase();
          
          // –Ü–º'—è
          if (!data.name && (fieldText.includes('name') || fieldText.includes('—ñ–º\'—è') || fieldText.includes('—ñ–º—è'))) {
            data.name = value;
          }
          // Instagram (–ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ü–ï–†–ï–î email!)
          else if (!data.instagram && (fieldText.includes('instagram') || fieldText.includes('—ñ–Ω—Å—Ç–∞–≥—Ä–∞–º') || 
                   (value.includes('@') && !value.includes('.') && !value.includes('+')))) {
            data.instagram = value;
          }
          // Email
          else if (!data.email && (type === 'email' || fieldText.includes('email') || 
                   (value.includes('@') && value.includes('.')))) {
            data.email = value;
          }
          // –¢–µ–ª–µ—Ñ–æ–Ω
          else if (!data.phone && (type === 'tel' || fieldText.includes('phone') || fieldText.includes('—Ç–µ–ª–µ—Ñ–æ–Ω') || 
                   /^[\+]?[\d\s\-\(\)]{7,}$/.test(value))) {
            data.phone = value;
          }
          // –ü–æ—Å–ª—É–≥–∞
          else if (!data.service && (input.tagName === 'SELECT' || fieldText.includes('service') || fieldText.includes('–ø–æ—Å–ª—É–≥–∞'))) {
            data.service = value;
          }
          // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –°–ê–ú –¥–æ–¥–∞–≤ –ø–æ–ª–µ)
          else if (!data.message && input.tagName === 'TEXTAREA') {
            data.message = value;
          }
          // –î–∞—Ç–∞
          else if (!data.date && (type === 'date' || fieldText.includes('date') || fieldText.includes('–¥–∞—Ç–∞'))) {
            data.date = value;
          }
          // –ß–∞—Å
          else if (!data.time && (type === 'time' || fieldText.includes('time') || fieldText.includes('—á–∞—Å'))) {
            data.time = value;
          }
        });
        
        return data;
      }

      // –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –æ–±—Ä–æ–±–Ω–∏–∫ —Ñ–æ—Ä–º - –ë–ï–ó –î–û–î–ê–í–ê–ù–ù–Ø –ó–ê–ô–í–ò–• –ü–û–õ–Ü–í
      function initTelegramNotifications() {
        async function handleFormSubmit(event) {
          event.preventDefault();
          
          const form = event.target;
          const data = smartFormDataCollection(form);

          const hasAnyData = Object.values(data).some(value => value && value.trim());
          
          if (!hasAnyData) {
            console.log('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö —É —Ñ–æ—Ä–º—ñ');
            return;
          }

          const submitButton = form.querySelector('button[type="submit"]') || 
                             form.querySelector('input[type="submit"]') ||
                             form.querySelector('button');

          const originalText = submitButton ? (submitButton.textContent || submitButton.value) : '';
          
          if (submitButton) {
            submitButton.textContent = '–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ...';
            submitButton.disabled = true;
            submitButton.style.opacity = '0.7';
          }

          try {
            const result = await sendToTelegram(data);
            
            if (result.success) {
              // –ü–†–ê–í–ò–õ–¨–ù–Ü –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó Google Ads –∑ GTM
              if (typeof gtag !== 'undefined') {
                // –ö–æ–Ω–≤–µ—Ä—Å—ñ—è –¥–ª—è AW-7239891504
                gtag('event', 'conversion', {
                  'send_to': 'AW-7239891504/urnsCLD0n_waEK_ZhfFA',
                  'value': 100,
                  'currency': 'UAH'
                });
                
                // –ö–æ–Ω–≤–µ—Ä—Å—ñ—è –¥–ª—è AW-17416940719
                gtag('event', 'conversion', {
                  'send_to': 'AW-17416940719/waLYCNbXjvwaEK_ZhfFA',
                  'value': 100,
                  'currency': 'UAH'
                });
                
                console.log('‚úÖ Google Ads –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ');
              }
              
              // GA4 –ø–æ–¥—ñ—è
              if (typeof gtag !== 'undefined') {
                gtag('event', 'purchase', {
                  'transaction_id': 'TAROT_' + Date.now(),
                  'value': 100,
                  'currency': 'UAH',
                  'event_category': '–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è',
                  'event_label': '–¢–∞—Ä–æ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è'
                });
              }
              
              // –û—á–∏—Å—Ç–∏—Ç–∏ —Ñ–æ—Ä–º—É
              form.reset();
              
              console.log('‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ!');
              
            } else {
              console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏:', result.error);
            }
            
          } catch (error) {
            console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è:', error);
          } finally {
            if (submitButton) {
              submitButton.textContent = originalText;
              submitButton.disabled = false;
              submitButton.style.opacity = '1';
            }
          }
        }

        // –ü–æ—à—É–∫ —ñ –æ–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º - –ë–ï–ó –î–û–î–ê–í–ê–ù–ù–Ø –ó–ê–ô–í–ò–• –ü–û–õ–Ü–í
        function attachToForms() {
          const forms = document.querySelectorAll('form');
          
          forms.forEach(form => {
            if (!form.hasAttribute('data-telegram-handler')) {
              form.setAttribute('data-telegram-handler', 'true');
              
              // –ù–ï –î–û–î–ê–Ñ–ú–û –ó–ê–ô–í–Ü –ü–û–õ–Ø!
              
              const newForm = form.cloneNode(true);
              form.parentNode.replaceChild(newForm, form);
              newForm.addEventListener('submit', handleFormSubmit);
              
              console.log('‚úÖ Telegram system attached to form');
            }
          });
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', attachToForms);
        } else {
          attachToForms();
        }

        setInterval(attachToForms, 2000);
      }

      // –¢–µ—Å—Ç–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è
      window.testTelegram = async function() {
        const testData = {
          name: '–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º–∏',
          phone: '+380123456789',
          service: 'individual',
          message: '–¢–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è'
        };
        
        try {
          const result = await sendToTelegram(testData);
          console.log('‚úÖ Test successful:', result);
        } catch (error) {
          console.error('‚ùå Test failed:', error);
        }
      };

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏
      initTelegramNotifications();
      
      console.log('üöÄ –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ Telegram —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞!');
    </script>

    <!-- –°—Ç–∏–ª—ñ –¥–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ—ó –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
    <style>
      html, body {
        overflow-x: hidden !important;
        max-width: 100vw !important;
      }
      
      * {
        box-sizing: border-box !important;
      }
      
      #root, #root > *, [class*="container"], [class*="wrapper"] {
        max-width: 100vw !important;
        overflow-x: hidden !important;
      }
      
      img, video, iframe {
        max-width: 100% !important;
        height: auto !important;
      }
      
      @media (min-width: 768px) {
        body {
          overflow-y: auto !important;
          overflow-x: hidden !important;
        }
      }
    </style>
  </body>
</html>